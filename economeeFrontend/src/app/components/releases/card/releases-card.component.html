<nz-card [nzActions]="release? [edit, delete]:[add, cancelAdd]"
         class="shadow card-release m-2 border-1">
  <form [formGroup]="releaseForm" nz-form>
    <div nz-row>
      <div nz-col nzSm="24">
        <h6>
          <nz-form-item>
            <input formControlName="description"
                   nz-input placeholder="{{release? release.description :'Descrição' }}" type="text">
          </nz-form-item>
        </h6>
      </div>
    </div>
    <div nz-row>
      <div nz-col nzSm="11">
        <h6>
          <nz-form-item>
            <nz-input-group [nzPrefix]="prefixCurrency">
              <input formControlName="value" placeholder="{{release? release.value:'Valor'}}" type="number">
            </nz-input-group>
            <ng-template #prefixCurrency>
              {{currency}}
            </ng-template>
          </nz-form-item>
        </h6>
      </div>
      <div nz-col nzSm="1"></div>
      <div nz-col nzSm="12">
        <nz-form-item>
          <!-- FIXME find a way to put date as dd/MMMM/YYYY -->
          <input formControlName="date_release" nz-input
                 placeholder="{{release? release.date_release :'Data de lançamento'}}}" type="date">
        </nz-form-item>
      </div>
    </div>
    <div nz-row>
      <div nz-col nzSm="11">
        <nz-form-item>
          <input formControlName="place" nz-input placeholder="{{release? release.place: 'Local'}}" type="text">
        </nz-form-item>
      </div>
      <div nz-col nzSm="1"></div>
      <div nz-col nzSm="12">
        <nz-form-item>
          <nz-input-group [nzAddOnBefore]="release?repeatTimes:null">
            <input formControlName="repeat_times" min="1" nz-input
                   placeholder="{{release? release.repeat_times :'Número de repetições'}}"
                   type="number"
                   value="1">
          </nz-input-group>
          <ng-template #repeatTimes>
            <span>Parcela {{release.installment_number}} de </span>
          </ng-template>
        </nz-form-item>
      </div>
    </div>
    <div nz-row nzJustify="space-around">
      <div nz-col nzSm="7">
        <nz-select [ngModel]="release? release.category.id :0" [nzDropdownRender]="renderTemplate" class="category"
                   formControlName="category_id">
          <nz-option [nzLabel]="'Categoria'" [nzValue]="0" nzDisabled></nz-option>
          <nz-option *ngFor="let c of categories" [nzLabel]=c.name [nzValue]=c.id></nz-option>
        </nz-select>
        <ng-template #renderTemplate>
          <nz-spin *ngIf="categoriesLoading"></nz-spin>
        </ng-template>
      </div>

      <div nz-col nzSm="7">
        <nz-select [ngModel]="release? release.type:0" class="type" formControlName="type">
          <nz-option [nzLabel]="'Tipo'" [nzValue]="0" nzDisabled></nz-option>
          <nz-option [nzLabel]="'Gasto'" [nzValue]="'ER'"></nz-option>
          <nz-option [nzLabel]="'Ganho'" [nzValue]="'IR'"></nz-option>
        </nz-select>
      </div>

      <div nz-col nzSm="7">
        <nz-select [ngModel]="release? release.is_release_paid: 0" class="paid" formControlName="is_release_paid">
          <nz-option [nzLabel]="'Está Pago?'" [nzValue]="0" nzDisabled></nz-option>
          <nz-option [nzLabel]="'Pago'" [nzValue]=true></nz-option>
          <nz-option [nzLabel]="'Não Pago'" [nzValue]="false"></nz-option>
        </nz-select>
      </div>
    </div>
  </form>
</nz-card>

<ng-template #delete>
  <button (click)="deleteRelease(release.id)" class="mx-2" nz-button nzDanger nzType="primary">
    <i nz-icon nzTheme="outline" nzType="delete"></i>
    Deletar
  </button>
</ng-template>
<ng-template #edit>
  <button (click)="editRelease(release.id)" class="mx-2" nz-button nzType="primary">
    <i nz-icon nzType="edit"></i>
    Editar
  </button>
</ng-template>
<ng-template #add>
  <button (click)="saveRelease()" class="mx-2" nz-button nzType="primary">
    <i nz-icon nzTheme="outline" nzType="plus"></i>
    Adicionar
  </button>
</ng-template>
<ng-template #cancelAdd>
  <button (click)="cancelRelease()" class="mx-2" nz-button nzDanger nzType="primary">
    <i nz-icon nzTheme="outline" nzType="stop"></i>
    Cancelar
  </button>
</ng-template>

